---
share: true
---
## Лог изменений
| № | Изменение | Автор | Дата |
| ---- | ---- | ---- | ---- |
| 1 | Добавлена таблица правил | @Sergey Petrukhin | 11.11.2023 |
| 2 | Требование про отображение быстрого запроса вынесено в отдельный документ | @Sergey Petrukhin | 30.11.2023 |

## Пользовательская история

[GRK-444 Схема отображения контактов и быстрого запроса](https://pmcloud.atlassian.net/browse/GRK-444)

|Как|Менеджер проекта|
|---|---|
|Я хочу|Видеть в API набор флагов, на основании которых нужно выводить или не выводить тот или иной способ связи|
|Чтобы|Отображать на клиенте способы связи, в соответствии с типом страницы, типом размещения и доменом|

## Контекст

---

На клиентских приложениях не хватает критериев вывода, что приводит к появлению лишних контактов и быстрого запроса, там где они не нужны.

Тезисно:

- Логику вывода/скрытия конкретных контактов и быстрого запроса далее называем «Схема отображения»
- Схему отображения нужно хранить в едином месте — на бекенде или в базе данных
- Каждая схема должна иметь привязку к домену и городу (опционально) и содержать правила согласно таблице Rules
- API должно отдавать только нужные контакты, согласно схеме
- Ответ API должен также содержать схему отображения в виде объекта с флагами в каждом методе, отдающим контакты непосредственно или в виде embed. Флаги приведены в таблице Parameters, а запросы в таблице API)
- Чтобы протестировать реализацию, помимо схемы в API, нужно вывести в панель администратора тип размещения заведения для тестировщика

## Rules

|domain in [[gorko.ru](http://gorko.ru), [wedding.net](http://wedding.net), [wedpro.com.ua](http://wedpro.com.ua), [kzwed.com](http://kzwed.com), [belwed.com](http://belwed.com), [slubowisko.pl](http://slubowisko.pl), [spotlyst.com](http://spotlyst.com), rsrv.rest, [wedexpert.com](http://wedexpert.com)]|
|---|
|Все города на всех доменах, исключая [centerwedding.com](http://centerwedding.com)|

|Размещение|Бесплатное|Абонентское|Комиссионное|
|---|---|---|---|
|Признак в базе|top == 0|top == 1 && commission == 0|top == 1 && commission > 0|

|Основной способ связи (Mobile)|Direct call|Direct call|Direct call|
|---|---|---|---|
|Основной способ связи (Desktop)|Окно контактов [ОК]|Окно контактов [ОК]|Окно контактов [ОК]|
|[ОК] Основной телефон|✔️Да|✔️Да|✔️Да|
|[ОК] Мессенджеры|✔️Да|✔️Да|❌Нет|
|[ОК] Единый мессенджер|❌Нет|❌Нет|❌Нет|
|[ОК] Личные сообщения|✔️Да|✔️Да|✔️Да|
|[ОК] Дополнительные контакты|✔️Да|✔️Да|❌Нет|

|domain == [centerwedding.com](http://centerwedding.com), cities == all|
|---|
|Все города только на домене [centerwedding.com](http://centerwedding.com)|

|Размещение|Бесплатное|Абонентское|Комиссионное|
|---|---|---|---|
|Признак в базе|top == 0|top == 1 && commission == 0|top == 1 && commission > 0|

|Основной способ связи (Mobile)|Окно контактов [ОК]|Окно контактов [ОК]|Окно контактов [ОК]|
|---|---|---|---|
|Основной способ связи (Desktop)|Окно контактов [ОК]|Окно контактов [ОК]|Окно контактов [ОК]|
|[ОК] Основной телефон|❌Нет|✔️Да|✔️Да|
|[ОК] Мессенджеры|❌Нет|✔️Да|❌Нет|
|[ОК] Единый мессенджер LINE|✔️Да|❌Нет|✔️Да|
|[ОК] Личные сообщения|✔️Да|✔️Да|✔️Да|
|[ОК] Дополнительные контакты|❌Нет|✔️Да|❌Нет|


## API
|Метод|Пример вызова|Платформа|
|---|---|---|
|…/v3/venuecard|https://documenter.getpostman.com/view/16718306/2sA2rCTgRm|Mobile, Desktop|
|…/v3/venue/venue_id|[https://api.gorko.ru/api/v3/venue/235145?entity[languageId]=1](https://api.gorko.ru/api/v3/venue/235145?entity%5BlanguageId%5D=1)|Mobile, Desktop|

## Parameters
|Параметр|Описание|Тип|
|---|---|---|
|showMainPhone|Основной телефон|Boolean|
|showMessengers|Мессенджеры|Boolean|
|showLine|Единый Line (Таиланд)|Boolean|
|showPM|Личные сообщения|Boolean|
|showAdditionalContacts|Дополнительные контакты|Boolean|
|showQuickInquiry|Быстрый запрос|Boolean|

![[venue_contacts.png|venue_contacts.png]]